{% extends "_template.html" %}

{% block title %}Nextzen Developers - API Key {{ key.api_key }}{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>
{% endblock %}

{% block container %}
{{ super() }}
<div class='page-header'>
    <h3>API Key <code>{{ key.api_key }}</code><button class="btn" data-clipboard-text="{{ key.api_key }}"><span class="glyphicon glyphicon-copy" aria-hidden="true"></span></button></h3>
</div>

{%- with messages = get_flashed_messages(with_categories=True) %}
{%- if messages %}
<div class="row">
  {{utils.flashed_messages(messages)}}
</div>
{%- endif %}
{%- endwith %}

<form method="POST">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
  <div class="form-group">
    <label for="apikey-note">Name</label>
    <input type="text" class="form-control" id="apikey-note" name="name" placeholder="Short description to help you remember what this API key was used for." value="{{ key.name or '' }}">
  </div>
  <div class="form-group">
    <label for="apikey-referers">Allowed Referers</label>
    <textarea class="form-control" id="apikey-referers" name="allowed_referers" placeholder="https://example.com/*">{{ '\n'.join(key.allowed_referers) if key.allowed_referers else '' }}</textarea>
  </div>
  <div class="form-group">
    <button class="btn btn-primary" type="submit" name="action" value="save">Save Changes</button>
  {% if key.enabled %}
    <button class="btn btn-warning" type="submit" name="action" value="disable">Disable</button>
  </div>
  {% else %}
    <button class="btn btn-warning" type="submit" name="action" value="enable">Enable</button>
  </div>

  <div class="form-group">
    <div class="panel panel-danger">
      <div class="panel-heading">
        <h3 class="panel-title">Danger!</h3>
      </div>
      <div class="panel-body">
        <p>Deleting your API key is permanent and is not recoverable.</p>
        <button class="btn btn-danger" type="submit" name="action" value="delete">Delete</button>
      </div>
    </div>
  </div>
  {% endif %}

</form>

{% endblock %}
